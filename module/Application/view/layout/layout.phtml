<?php use Application\Service\Invokable;

echo $this->doctype(); ?>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <?=$this->headTitle($this->meta_title ?: $this->translate('ZCSM - a lightweight Content Management System'))."\n"?>
    <?=$this->headMeta()
        ->appendName('description', $this->meta_description ?: $this->translate('A CMS based on ZendFramework'))
        ->appendName('keywords', $this->meta_keywords ?: $this->translate('ZCMS, CMS, content management system'))."\n"?>
<!--<link rel="stylesheet" href="../../../../public/css/bootstrap.min.css" />--><!--V_TODO - remove--><!--V_TODO - remove--><!--V_TODO - remove-->
    <?=$this->headLink()
        ->prependStylesheet($this->basePath() .'/css/style.css')
        ->prependStylesheet($this->basePath() .'/css/bootstrap-theme.min.css')
        ->prependStylesheet($this->basePath() . '/css/bootstrap.min.css')
    ?>

    <?=$this->headScript()
        ->prependFile($this->basePath() . '/js/bootstrap.min.js')
        ->prependFile($this->basePath() . '/js/jquery-2.1.4.min.js')
        ->appendFile($this->basePath() . '/js/jscript.js');
    ?>

</head>
<body>
<div id="main">
    <div id="header">
        <div class="main">
            <div class="col-sm-2">
                <h3><a class="btn btn-default" href="<?=$this->langUrl('home')?>">ZCMS</a></h3>
            </div>
            <div class="col-sm-10" style="text-align: right;padding:10px;">
                <?php foreach(Invokable\Misc::getActiveLangsArray() as $lang):?>
                    <a href="<?=$this->url('home', [
                        'lang' => $lang['isoCode'] != Invokable\Misc::getDefaultLanguage()->getIsoCode() ? $lang['isoCode'] : null,//if the language is the default, then do not append with language route
                    ])?>"><img src="<?=$this->basePath().'/img/flags/'.$lang['isoCode']?>.png" /></a>
                <?php endforeach; ?>
            </div>
        </div>
    </div>
    <div id="main-content" class="main" style="border-left:1px solid #E1E1E1;border-right:1px solid #E1E1E1;">
        <div>
            <div class="col-sm-3" style="margin-top: 20px;">
                <?php foreach(Invokable\Layout::getTopCategories() as $category):?>
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h3 class="panel-title"><a href="<?=$this->langUrl('category', ['alias' => $category['content']['alias']])?>"><?=$category['content']['title']?></a></h3>
                        </div>
                        <ul class="list-group">
                            <?php foreach($category['listings'] as $listing):?>
                                <li class="list-group-item">
                                    <a  href="<?=$this->langUrl('page', ['alias' => urlencode($listing['content']['alias'])])?>">
                                        <?=$listing['content']['link']?>
                                    </a>
                                </li>

                            <?php endforeach; ?>
                        </ul>
                    </div>
                <?php endforeach; ?>

                <!--custom pages-->
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title"><?=$this->translate('Information')?></h3>
                    </div>
                    <ul class="list-group">
                        <li class="list-group-item">
                            <a href="<?=$this->langUrl('application/default', ['controller' => 'customPage', 'action' => 'contact'])?>"><?=$this->translate('Contact')?></a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-sm-9">
                <div class="bcrumb">
                    <?php if($crumb = Invokable\Layout::breadcrumb($title)): ?>
                        <?php $bCrumb = [];
                        foreach($crumb as $bItem):?>
                            <?php $bCrumb[] = !$bItem ? '<a href="'.$this->langUrl('home').'">'.$this->translate('Top').'</a>' : '<a href="'.$this->langUrl('category', ['alias' => $bItem['alias']]).'">'.$bItem['title'].'</a>'?>
                        <?php endforeach; ?>
                        <?=implode(' &gt; ', $bCrumb)?> &gt; <?=$title?>
                    <?php endif; ?>
                </div>
                <div class="messages">
                    <?php foreach (array('error', 'success', 'info', 'default') as $namespace):
                        $flashMessages = $this->flashmessenger()->render($namespace);
                        $namespace = $namespace == 'error' ? 'danger' : $namespace;/*adjust bootstrap to ZF2*/
                        if (!empty($flashMessages)):?>
                            <div class="alert alert-<?= $namespace ?>">
                                <?= $flashMessages ?>
                            </div>
                        <?php endif;
                    endforeach; ?>
                </div>
                <div class="content">
                    <?=$this->content?>
                </div>
            </div>
        </div>
<div class="clearfix"></div>
    </div>
    <footer id="footer">
        <hr />
        &copy; <?=date('Y')?> ZCMS - released under the <a target="_blank" href="http://www.gnu.org/licenses/gpl-3.0.en.html">GNU/GPL 3.0 licence</a>
    </footer>
</div>

</body>
</html>